<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>「NO MORE ドタキャン」ご依頼フォーム</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h2 {
            text-align: center;
        }
        .question {
            font-size: 18px;
            margin-bottom: 20px;
        }
        .input-field {
            width: 96%;
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        .error-message {
            color: red;
            font-size: 14px;
            margin-top: 5px;
        }
        .button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #0011FF;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }
        .button1 {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #0011FF;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }
        .button:hover {
            background-color: #0011FF;
        }
        .hide {
            display: none;
        }
        .review-section {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
<div class="container">
    <h2 id="dynamic-heading">「NO MORE ドタキャン」ご依頼フォーム</h2>

    <!-- 質問セクション -->
<div id="question1" class="question-section">
    <div class="question">氏名（必須）</div>
    <input type="text" id="answer1" class="input-field" name="name" placeholder="名前を入力" required>
    <div id="error1" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(1)">次へ</button>
</div>

<div id="question2" class="question-section hide">
    <div class="question">会社名（任意）</div>
    <input type="text" id="answer2" class="input-field" placeholder="会社名を入力">
    <div id="error2" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(2)">次へ</button>
</div>

<div id="question3" class="question-section hide">
    <div class="question">電話番号（必須）（半角で入力）</div>
    <input type="tel" id="answer3" class="input-field" name="name" placeholder="電話番号を入力(01234567890)" pattern="[0-9]{2,4}[0-9]{2,4}[0-9]{4}" required>

    <div id="error3" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(3)">次へ</button>
</div>

<div id="question4" class="question-section hide">
    <div class="question">メールアドレス（必須）</div>
    <input type="email" id="answer4" class="input-field" placeholder="メールアドレスを入力" required>
    <div id="error4" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(4)">次へ</button>
</div>

<div id="question5" class="question-section hide">
    <div class="question">店舗名（必須）</div>
    <input type="text" id="answer5" class="input-field" placeholder="店舗名を入力" required>
    <div id="error5" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(5)">次へ</button>
</div>

<div id="question6" class="question-section hide">
    <div class="question">店舗住所（必須）</div>
    <input type="text" id="answer6" class="input-field" placeholder="店舗住所を入力" required>
    <div id="error6" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(6)">次へ</button>
</div>

<div id="question7" class="question-section hide">
    <div class="question">店舗電話番号（必須）半角でご入力</div>
    <input type="tel" id="answer7" class="input-field" placeholder="店舗電話番号を入力(01234567890)" pattern="[0-9]{2,4}[0-9]{2,4}[0-9]{4}" required>
    <div id="error7" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(7)">次へ</button>
</div>

<div id="question8" class="question-section hide">
    <div class="question">相手方の名前（必須）</div>
    <input type="text" id="answer8" class="input-field" placeholder="相手方の名前を入力" required>
    <div id="error8" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(8)">次へ</button>
</div>

<div id="question9" class="question-section hide">
    <div class="question">相手方の電話番号（必須）半角でご入力</div>
    <input type="tel" id="answer9" class="input-field" placeholder="相手方の電話番号を入力(01234567890)" pattern="[0-9]{2,4}[0-9]{2,4}[0-9]{4}" required>
    <div id="error9" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(9)">次へ</button>
</div>

<div id="question10" class="question-section hide">
    <div class="question">相手方の予約内容（必須）</div>
    <input type="text" id="answer10" class="input-field" placeholder="相手方の予約内容を入力" required>
    <div id="error10" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(10)">次へ</button>
</div>

<div id="question11" class="question-section hide">
    <div class="question">相手方の予約金額（必須）（半角で数字のみご入力ください。）（コースでない場合は、平均客単価）</div>
    <div id="error11" class="error-message hide">名前を入力してください。</div>
    <input type="number" id="answer11" class="input-field" placeholder="相手方の予約金額を入力" required>
    <button class="button" onclick="nextQuestion(11)">次へ</button>
</div>

<div id="question12" class="question-section hide">
    <div class="question">相手方の予約日（必須）</div>
    <input type="datetime-local" id="answer12" class="input-field" required>
    <div id="error12" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(12)">次へ</button>
</div>

<div id="question13" class="question-section hide">
    <div class="question">口座名義人（任意）(回収後にフォームを送付するので、その際の入力でも結構です。以下同じ。)</div>
    <input type="text" id="answer13" class="input-field" placeholder="口座名義人を入力">
    <div id="error13" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(13)">次へ</button>
</div>

<div id="question14" class="question-section hide">
    <div class="question">金融機関名（任意）</div>
    <input type="text" id="answer14" class="input-field" placeholder="金融機関名を入力">
    <div id="error14" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(14)">次へ</button>
</div>

<div id="question15" class="question-section hide">
    <div class="question">支店名（任意）</div>
    <input type="text" id="answer15" class="input-field" placeholder="支店名を入力">
    <div id="error15" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(15)">次へ</button>
</div>

<div id="question16" class="question-section hide">
    <div class="question">口座種類（任意）</div>
    <input type="text" id="answer16" class="input-field" placeholder="口座種類を入力">
    <div id="error16" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(16)">次へ</button>
</div>

<div id="question17" class="question-section hide">
    <div class="question">口座番号（任意）</div>
    <input type="number" id="answer17" class="input-field" placeholder="口座番号を入力">
    <div id="error17" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(17)">次へ</button>
</div>
<div id="question18" class="question-section hide">
    <div class="question">その他（補足説明等をご記載ください。）（任意）</div>
    <input type="text" id="answer18" class="input-field" placeholder="補足説明等を入力">
    <div id="error18" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(18)">次へ</button>
</div>
<div id="question19" class="question-section hide">
    <div class="question">個人の身分証(運転免許証等）(必須)</div>
    <input type="file" id="answer19" class="input-field"required>
    <div id="error19" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(19)">次へ</button>
</div>
<div id="question20" class="question-section hide">
    <div class="question">キャンセルポリシー（任意）</div>
    <input type="file" id="answer20" class="input-field">
    <div id="error20" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="nextQuestion(20)">次へ</button>
</div>
<div id="question21" class="question-section hide">
    <div class="question">その他資料(契約書等が存在する場合には契約書等）</div>
    <input type="file" id="answer21" class="input-field">
    <div id="error21" class="error-message hide">名前を入力してください。</div>
    <button class="button" onclick="showReview()">確認する</button>
</div>

    <!-- 確認セクション -->
    <div id="review" class="hide">
        <h3>回答内容(修正可)</h3>
        <div class="review-section">
            <label for="review1">氏名</label>
            <input type="text" id="review1" class="input-field"name="name1"required>
            <div id="error_1" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review2">会社名</label>
            <input type="text" id="review2" class="input-field"name="name2">
            <div id="error_2" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review3">電話番号</label>
            <input type="" id="review3" class="input-field"name="name3"required>
            <div id="error_3" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review4">メールアドレス</label>
            <input type="email" id="review4" class="input-field"name="name4"required>
            <div id="error_4" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review5">店舗名</label>
            <input type="text" id="review5" class="input-field"name="name5"required>
            <div id="error_5" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review6">店舗住所</label>
            <input type="text" id="review6" class="input-field"required>
            <div id="error_6" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review7">店舗電話番号</label>
            <input type="tel" id="review7" class="input-field"required>
            <div id="error_7" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review8">相手方の名前</label>
            <input type="text" id="review8" class="input-field"required>
            <div id="error_8" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review9">相手方の電話番号</label>
            <input type="tel" id="review9" class="input-field"required>
            <div id="error_9" class="error-message hide"></div>
        </div>
      　<div class="review-section">
            <label for="review10">相手方の予約内容</label>
            <input type="text" id="review10" class="input-field"required>
            <div id="error_10" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review11">相手方の予約金額</label>
            <input type="number" id="review11" class="input-field"required>
            <div id="error_11" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review12">相手方の予約日</label>
            <input type="datetime-local" id="review12" class="input-field"required>
            <div id="error_12" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review13">口座名義人</label>
            <input type="text" id="review13" class="input-field">
            <div id="error_13" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review14">金融機関名</label>
            <input type="text" id="review14" class="input-field">
            <div id="error_14" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review15">支店名</label>
            <input type="text" id="review15" class="input-field">
            <div id="error_15" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review16">口座種類</label>
            <input type="text" id="review16" class="input-field">
            <div id="error_16" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review17">口座番号</label>
            <input type="number" id="review17" class="input-field">
            <div id="error_17" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review18">補足説明等</label>
            <input type="text" id="review18" class="input-field">
            <div id="error_18" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review19">個人の身分証(運転免許証等）</label>
            <input type="file" id="review19" class="input-field"required>
            <div id="error_19" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review20">キャンセルポリシー</label>
            <input type="file" id="review20" class="input-field">
            <div id="error_20" class="error-message hide"></div>
        </div>
        <div class="review-section">
            <label for="review21">その他資料(契約書等が存在する場合には契約書等）</label>
            <input type="file" id="review21" class="input-field">
            <div id="error_21" class="error-message hide"></div>
        </div>
        <div class="checkbox-container">
            <label>
                <input type="checkbox" id="review22"required> 利用規約を読んだ上で同意します。
                <div id="error_22" class="error-message hide"></div>
            </label>
            <br>
            <a href="https://morikazu-law.com/termsofservice/" target="_blank">利用規約はこちら</a>
        <div class="checkbox-container">
            <label>
                <input type="checkbox" id="review23"required> プライバシーポリシーを読んだ上で同意します。
                <div id="error_23" class="error-message hide"></div>
            </label>
            <br>
            <a href="https://morikazu-law.com/privacypolicy/" target="_blank">プライバシーポリシーはこちら</a>

        <button class="button1" onclick="submitForm()">送信する</button>
    </div>

</div>


<script>
        function nextQuestion(questionNumber) {
            const currentInput = document.getElementById('answer' + questionNumber);
            const errorElement = document.getElementById('error' + questionNumber);

            // バリデーションエラーがない場合
            errorElement.classList.add('hide');
            document.getElementById('question' + questionNumber).classList.add('hide');
            if (questionNumber < 21) {
                document.getElementById('question' + (questionNumber + 1)).classList.remove('hide');
            }
        }

    function showReview() {
        document.getElementById('question21').classList.add('hide');
        document.getElementById('review').classList.remove('hide');
        
        // 確認セクションに値を反映
        document.getElementById('review1').value = document.getElementById('answer1').value;
        document.getElementById('review2').value = document.getElementById('answer2').value;
        document.getElementById('review3').value = document.getElementById('answer3').value;
        document.getElementById('review4').value = document.getElementById('answer4').value;
        document.getElementById('review5').value = document.getElementById('answer5').value;
        document.getElementById('review6').value = document.getElementById('answer6').value;
        document.getElementById('review7').value = document.getElementById('answer7').value;
        document.getElementById('review8').value = document.getElementById('answer8').value;
        document.getElementById('review9').value = document.getElementById('answer9').value;
        document.getElementById('review10').value = document.getElementById('answer10').value;
        document.getElementById('review11').value = document.getElementById('answer11').value;
        document.getElementById('review12').value = document.getElementById('answer12').value;
        document.getElementById('review13').value = document.getElementById('answer13').value;
        document.getElementById('review14').value = document.getElementById('answer14').value;
        document.getElementById('review15').value = document.getElementById('answer15').value;
        document.getElementById('review16').value = document.getElementById('answer16').value;
        document.getElementById('review17').value = document.getElementById('answer17').value;
        document.getElementById('review18').value = document.getElementById('answer18').value;
        document.getElementById('review19').files = document.getElementById('answer19').files;
        document.getElementById('review20').files = document.getElementById('answer20').files;
        document.getElementById('review21').files = document.getElementById('answer21').files;

    }

      function submitForm() {
        let isActive = false;

        document.getElementById('review').classList.add('hide');
　　　　const heading = document.getElementById("dynamic-heading");
        heading.innerText = "送信完了";
   　　 heading.style.fontSize = "40px"; // ピクセルで指定
//	const container = document.querySelector('.container');

	// 幅と高さを変更
//	container.style.width = '500px';
//	container.style.height = '300px';
      }

</script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>
        
        $(document).ready(function () {
            const liffId = "2006599559-V1BDwPRp";
            initializeLiff(liffId);
        })

        function initializeLiff(liffId) {
            liff.init({
                liffId: liffId
            }).then(() => {
                initializeApp();
            }).catch((err) => {
                console.log('LIFF Initialization failed ', err);
            });
        }

 function sendTextAndFile(text, file) {
    const messages = [{
        'type': 'text',
        'text': text
    }];
    
    if (file) {
        const fileMessage = {
            'type': 'file',
            'originalContentUrl': file.url,  // ファイルURL（URLを指定する必要あり）
            'fileName': file.name            // ファイル名
        };
        messages.push(fileMessage);
    }

    liff.sendMessages(messages)
        .then(function () {
            liff.closeWindow();
        })
        .catch(function (error) {
            // エラー内容を詳細にログ出力する
            console.error('Failed to send message. Error details:', error);
            
            // エラー情報をユーザーにわかりやすく表示
            let errorMessage = `Failed to send message. Please check the details:\n\n`;
            errorMessage += `Error Name: ${error.name || 'Unknown'}\n`;
            errorMessage += `Error Message: ${error.message || 'No message available'}\n`;

            // オブジェクト形式の場合に備え、エラーの中身をJSON文字列化
            if (typeof error === 'object') {
                errorMessage += `Error Details: ${JSON.stringify(error, null, 2)}`;
            } else {
                errorMessage += `Error Details: ${error}`;
            }

            // アラート表示
            window.alert(errorMessage);
        });
}


        
        const params = (new URL(document.location)).searchParams;
        const key = params.get('key');

        // ボタンがクリックされたときの処理
        $(function () {
            $('.button1').click(function () {
                const name1 = $('input[name="name1"]').val();
                const name2 = $('input[name="name2"]').val();
                const name3 = $('input[name="name3"]').val();
                const name4 = $('input[name="name4"]').val();
                const name5 = $('input[name="name5"]').val();
                
                const msg = `${name1}\n${name2}\n${name3}\n${name4}\n${name5}`;

                // ファイルの取得
                const fileInput = $('#review19')[0];
                let file = null;
                if (fileInput.files.length > 0) {
                    file = fileInput.files[0];
                }

                // ファイルが選ばれていればそのURLを取得
                let fileUrl = null;
                if (file) {
                    const fileReader = new FileReader();
                    fileReader.onloadend = function() {
                        fileUrl = fileReader.result;
                        sendTextAndFile(msg, { url: fileUrl, name: file.name });
                    };
                    fileReader.readAsDataURL(file); // ファイルを読み込む
                } else {
                    sendTextAndFile(msg, null); // ファイルがない場合はテキストだけ送信
                }

                return false; // フォーム送信を防ぐ
            });
        });

    </script>



</body>
</html>
